<html>
    <head>
        <meta charset='utf-8' />
        <title>amble maps testing</title>
        <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
        <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.44.1/mapbox-gl.js'></script>
        <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.44.1/mapbox-gl.css' rel='stylesheet' />
        <script src="https://cdn.jsdelivr.net/npm/places.js@1.4.18"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
        <meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, shrink-to-fit=no' name='viewport' />
        <!--     Fonts and icons     -->
        <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700,200" rel="stylesheet" />
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css" />
        <!-- CSS Files -->
        <link href="assets/css/bootstrap.min.css" rel="stylesheet" />
        <link href="assets/css/now-ui-kit.css?v=1.1.0" rel="stylesheet" />
        <!-- CSS Just for demo purpose, don't include it in your project -->
        <link href="assets/css/demo.css" rel="stylesheet" />

        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
        <style>
            body { margin:0; padding:0; }
            #map { position:absolute; top:0; bottom:0; width:100%; }
        </style>
    </head>

    <body>
        <div id='map' style=''></div>

        <script>
    mapboxgl.accessToken = 'pk.eyJ1IjoianVsaWVud2V5bCIsImEiOiJjamRrYmw4aHYxdWhpMndwZ216bmg5ZWk4In0.lCyVC0ADMzqycojHa2KNfg';
    var map = new mapboxgl.Map({
    container: 'map',
    center: [-0.1259761,51.5289439],
    zoom: 13.5,
    style: 'mapbox://styles/mapbox/basic-v9', 
    });

    map.on('load', function() {
      createMap();
    });

function createMap(data) {
        map.addLayer({
            "id": "route",
            "type": "line",
            "source": {
                "type": "geojson",
                "data": {
                    "type": "Feature",
                    "properties": {},
                    "geometry": {"coordinates": [[-0.1259761,51.5289439],[-0.1260077,51.5289782],[-0.1260364,51.5290124],[-0.1260825,51.5290822],[-0.1261688,51.5290456],[-0.1263977,51.5289618],[-0.1272495,51.5286247],[-0.1273122,51.5285999],[-0.1274292,51.5285537],[-0.1277612,51.5284258],[-0.1278676,51.5283868],[-0.127989,51.5283367],[-0.1283226,51.5282064],[-0.128937,51.5279664],[-0.1294485,51.5277632],[-0.1294854,51.5277492],[-0.1296541,51.5276851],[-0.1297558,51.5276468],[-0.1304767,51.5273755],[-0.1305953,51.5273313],[-0.1306268,51.52732],[-0.130753,51.5272742],[-0.1309658,51.5271995],[-0.1319686,51.5268463],[-0.1320037,51.5268335],[-0.1320883,51.5268045],[-0.1329825,51.5264965],[-0.1331705,51.526431],[-0.1333895,51.5263548],[-0.1334315,51.5263416],[-0.1335714,51.5262963],[-0.133737,51.5262446],[-0.1345323,51.525976],[-0.1350932,51.5257877],[-0.1351889,51.5257545],[-0.1352378,51.5257375],[-0.1353498,51.5256987],[-0.1355596,51.5256012],[-0.1357278,51.5255403],[-0.1357643,51.5255185],[-0.1357988,51.5254986],[-0.1358394,51.5254729],[-0.1358263,51.5254552],[-0.1354366,51.5250624],[-0.1353644,51.5250047],[-0.1349338,51.5245621],[-0.1348767,51.5245086],[-0.1345781,51.5242289],[-0.134254,51.5239252],[-0.1339714,51.5236702],[-0.1326875,51.5224975],[-0.1326504,51.5224671],[-0.1326138,51.5224372],[-0.1325796,51.5224021],[-0.1315953,51.5214361],[-0.1315463,51.521388],[-0.1308153,51.520767],[-0.1303964,51.5204185],[-0.1303394,51.5203627],[-0.1300417,51.5200926],[-0.1296598,51.5197464],[-0.1295881,51.5196863],[-0.1291999,51.5193182],[-0.128798,51.5189481],[-0.1283787,51.5185576],[-0.1282467,51.5184396],[-0.1281668,51.5183703],[-0.1281093,51.5183513],[-0.1280787,51.5183392],[-0.1280579,51.5183194],[-0.1279982,51.5182626],[-0.1279771,51.5182034],[-0.1278957,51.5181228],[-0.1276504,51.5178409],[-0.1276138,51.5177898],[-0.1274763,51.5178235],[-0.1271056,51.5179111],[-0.1269775,51.5179439],[-0.1267345,51.518006],[-0.1261146,51.5182278],[-0.1258618,51.5183299],[-0.1259008,51.5183729],[-0.1258062,51.5184775]], "type": "LineString"}
                }
            },
            "layout": {
                "line-join": "round",
                "line-cap": "round"
            },
            "paint": {
                "line-color": "#66CD00",
                "line-width": 5
            }
        });
        map.addLayer({
            "id": "route2",
            "type": "line",
            "source": {
                "type": "geojson",
                "data": {
                    "type": "Feature",
                    "properties": {},
                    "geometry": {"coordinates": [[-0.1259761,51.5289439],[-0.1256889,51.5286098],[-0.1255061,51.5284031],[-0.1253509,51.5282371],[-0.1260032,51.5279808],[-0.1265035,51.5277843],[-0.1271102,51.5275459],[-0.1259154,51.5262399],[-0.125691,51.5260101],[-0.1255601,51.5257562],[-0.1255483,51.5257333],[-0.1255336,51.5257037],[-0.1255137,51.5256667],[-0.1254809,51.5255965],[-0.1251859,51.5249783],[-0.1248025,51.5243766],[-0.1247827,51.524346],[-0.1247538,51.5242993],[-0.124658,51.5241377],[-0.1245943,51.5240285],[-0.1241941,51.5233422],[-0.1241477,51.5232628],[-0.1242476,51.5232405],[-0.1249831,51.5230764],[-0.1253817,51.5229627],[-0.1256388,51.5228776],[-0.1257866,51.5228137],[-0.1259408,51.5227471],[-0.1258803,51.5226923],[-0.1258205,51.5226889],[-0.1258596,51.5225664],[-0.1258937,51.522517],[-0.1259476,51.5223124],[-0.1259343,51.522157],[-0.1259266,51.5220667],[-0.1259081,51.5219484],[-0.125955,51.5218471],[-0.1259973,51.521765],[-0.1259611,51.5217593],[-0.1259316,51.5217499],[-0.1259007,51.5217334],[-0.1258705,51.5217024],[-0.1258608,51.521674],[-0.1258609,51.5216611],[-0.1258703,51.5216339],[-0.1258889,51.5216119],[-0.1259264,51.5215883],[-0.1259656,51.5215757],[-0.1260371,51.5215709],[-0.1260624,51.5215113],[-0.1260675,51.5214537],[-0.1260894,51.5213716],[-0.1261481,51.5212605],[-0.1262088,51.5211621],[-0.1262495,51.5209994],[-0.1262442,51.5208807],[-0.1262536,51.5208222],[-0.1263426,51.5207132],[-0.126286,51.5206578],[-0.1262374,51.5206128],[-0.126204,51.5205837],[-0.1261849,51.5205659],[-0.1262362,51.5205425],[-0.1262872,51.5205222],[-0.1262298,51.5204697],[-0.1254851,51.5198409],[-0.1254294,51.5197928],[-0.1245079,51.5190225],[-0.1244557,51.5189788],[-0.1244106,51.5189418],[-0.1245726,51.5188714],[-0.1247317,51.5188018],[-0.1247921,51.5187766],[-0.1253766,51.5185322],[-0.1257112,51.5183907],[-0.1258618,51.5183299],[-0.1259008,51.5183729],[-0.1258062,51.5184775]], "type": "LineString"}
                }
            },
            "layout": {
                "line-join": "round",
                "line-cap": "round"
            },
            "paint": {
                "line-color": "#000",
                "line-width": 5
            }
        });
        map.addLayer({
          id: 'start',
          type: 'circle',
          source: {
            type: 'geojson',
            data: {
              type: 'Feature',
              geometry: {
                type: 'Point',
                coordinates: [-0.1259761,51.5289439]
              }
            }
          }
        });
        map.addLayer({
          id: 'end',
          type: 'circle',
          source: {
            type: 'geojson',
            data: {
              type: 'Feature',
              geometry: {
                type: 'Point',
                coordinates: [-0.1258062,51.5184775]
              }
            }
          }
        });
}

// Manage the current position on the map
var lat = null;
var lng = null;

navigator.geolocation.getCurrentPosition(function(position) {
    var locationMarker = null;
    if (locationMarker){
      // return if there is a locationMarker bug
      return;
    }
    // sets default position to your position
    lat = position.coords["latitude"];
    lng = position.coords["longitude"];
    currentCoordinates = '[' + lng + ',' + lat + ']';
    console.log(currentCoordinates)
    },
    function(error) {
    console.log("Error: ", error);
    },
    {
    enableHighAccuracy: true
    })

// Add geolocate control to the map.
map.addControl(new mapboxgl.GeolocateControl({
    positionOptions: {
        enableHighAccuracy: true
    },
    trackUserLocation: true
}));

// Add zoom and rotation controls to the map.
map.addControl(new mapboxgl.NavigationControl());

        </script>

    <div id="input-styling-address" class="card" style="width: 30%; padding-top: 10px; padding-left: 10px; padding-right: 10px; margin-top: 10px; margin-left: 10px">
    <h6>Amble map route vs fastest route: test us!</h6>
    <form class="form" id="form-address">
        <div class="form">
            <label for="form-address"></label>
            <input type="search" id="address-input-origin" placeholder="Origin" style=""/>
        </div>
        <div class="form" style="padding-bottom: 5px">
            <label for="form-address"></label>
            <input type="search" id="address-input-destination" placeholder="Destination" style=""/>
        </div>
        <button class="btn btn-primary btn-sm" id="button">Show me the way</button>
        <h10 style="font-size: 10;">*only available in London</h10> 
    </form>
</div>
    <div class="card" style="width: 30%; padding-top: 10px; padding-left: 10px; padding-right: 10px; padding-bottom: 10px; margin-left: 10px">
        <h7 id="test">With amble, you can optimise your route based on your preferences.</h7>
    </div>

            <script>
              var placesAutocomplete = places({
                container: document.querySelector('#address-input-origin'),
              });
              var placesAutocomplete = places({
                container: document.querySelector('#address-input-destination'),
              });

    // Prevent button reload for form
    $("#form-address").submit(function(e){
        e.preventDefault();
    })
    // Create variable for address information
    $("#button").click(function(e){
        var addressOrigin = $("#address-input-origin").val();
        var addressDestination = $("#address-input-destination").val();
        var addressInfomation = {
            "start": addressOrigin,
            "end": addressDestination,
            "user_id": "2"
        }
    // Query set-up
    var b = jQuery.parseJSON( '{ "start": "camden town station, London, United Kingdom", "end": "baker street station, London, United Kingdom", "user_id": 2 }' );
    console.log(addressInfomation)
    // POST request to server
    $.ajax({
        url: "35.197.240.46:5000",
        data: addressInfomation,
        type: "POST",
        success: function (data) {
            console.log(data);
            // createMap(data.addressInfomation);
        },
        error: function (data){
            console.log(data.responseText);
        }
    })
})
            </script>
        </div>
    <body>
</html>






